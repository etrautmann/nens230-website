<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta name="generator" content="jemdoc, see http://jemdoc.jaboc.net/" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link rel="stylesheet" href="jemdoc.css" type="text/css" />
<title>nens230 | week3</title>
</head>
<body>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
    var pageTracker = _gat._getTracker("UA-44238171-1");
    pageTracker._trackPageview();
} catch(err) {}</script>
<table summary="Table for page layout." id="tlayout">
<tr valign="top">
<td id="layout-menu">
<div class="menu-category">Course Information</div>
<div class="menu-item"><a href="index.html">home</a></div>
<div class="menu-item"><a href="syllabus.html">syllabus</a></div>
<div class="menu-category">Lectures</div>
<div class="menu-item"><a href="lecture1.html">lecture&nbsp;1:&nbsp;introduction</a></div>
<div class="menu-item"><a href="lecture2.html">lecture&nbsp;2:&nbsp;arrays&nbsp;and&nbsp;data</a></div>
<div class="menu-item"><a href="lecture3.html">lecture&nbsp;3:&nbsp;loops&nbsp;and&nbsp;control&nbsp;flow</a></div>
<div class="menu-item"><a href="lecture4.html">lecture&nbsp;4:&nbsp;plotting&nbsp;and&nbsp;graphics</a></div>
<div class="menu-item"><a href="lecture5.html">lecture&nbsp;5:&nbsp;cell&nbsp;arrays,&nbsp;struct&nbsp;arrays,&nbsp;and&nbsp;debugging</a></div>
<div class="menu-item"><a href="lecture6.html">lecture&nbsp;6:&nbsp;software&nbsp;best&nbsp;practices</a></div>
<div class="menu-category">Assignments</div>
<div class="menu-item"><a href="week0.html">week&nbsp;0:&nbsp;getting&nbsp;matlab</a></div>
<div class="menu-item"><a href="week1.html">week&nbsp;1:&nbsp;variables</a></div>
<div class="menu-item"><a href="week2.html">week&nbsp;2:&nbsp;data&nbsp;manipulation</a></div>
<div class="menu-item"><a href="week3.html" class="current">week&nbsp;3:&nbsp;loops&nbsp;and&nbsp;control&nbsp;flow</a></div>
<div class="menu-item"><a href="week4.html">week&nbsp;4:&nbsp;data&nbsp;visualization</a></div>
<div class="menu-item"><a href="week5.html">week&nbsp;5:&nbsp;cell&nbsp;arrays&nbsp;and&nbsp;struct&nbsp;arrays</a></div>
<div class="menu-item"><a href="week6.html">week&nbsp;6:&nbsp;software&nbsp;best&nbsp;practices</a></div>
<div class="menu-category">Tips &amp; Tricks</div>
<div class="menu-item"><a href="terminology.html">Terminology</a></div>
<div class="menu-item"><a href="braces.html">Brackets,&nbsp;Parentheses,&nbsp;and&nbsp;Curly&nbsp;Braces</a></div>
<div class="menu-category">External Links</div>
<div class="menu-item"><a href="http://www.mathworks.com/help/matlab/">documentation</a></div>
<div class="menu-item"><a href="files/lecture6/matlab-style-guide.pdf">Matlab&nbsp;style&nbsp;guide</a></div>
<div class="menu-item"><a href="http://blogs.mathworks.com/loren/">Loren&nbsp;on&nbsp;the&nbsp;Art&nbsp;of&nbsp;Matlab</a></div>
<div class="menu-item"><a href="http://www.undocumentedmatlab.com/">Undocumented&nbsp;Matlab</a></div>
</td>
<td id="layout-content">
<div id="toptitle">
<h1>Week 3: Logic, loops and control flow</h1>
<div id="subtitle">In this assignment, you will analyze fluorescence imaging data using <tt>for</tt> loops and <tt>if/else</tt>
branching techniques.<br />
<b>This assignment is due on Tuesday, 14 Oct at 9:30am</b></div>
</div>
<h2>Files</h2>
<p>The description of the assignment can be found here:
<a href="files/assignment3/assignment3.pdf" target=&ldquo;blank&rdquo;>Assignment 3 (PDF)</a></p>
<p>You can download a zip archive of all the files you'll need, as well as starter code, here:
<a href="files/assignment3/assignment3-files.zip" target=&ldquo;blank&rdquo;>Assignment 3 Files (zip)</a></p>
<h2>Submission</h2>
<p>Email your code and figures (output of the <tt>publish</tt> command) to the staff mailing list 
(<a href="mailto:nens230-aut1415-staff@lists.stanford.edu" target=&ldquo;blank&rdquo;>nens230-aut1415-staff@lists.stanford.edu</a>) with <tt>[Assignment 3]</tt> in the subject line.</p>
<h2>Solution</h2>
<p>The solution can be downloaded here:
<a href="files/assignment3/assignment3_soln.m" target=&ldquo;blank&rdquo;>Assignment 3 Solution</a></p>
<h2>A comment on part 2</h2>
<p>After grading assignment 3, we've noticed a very common mistake in part 2, which we
wanted to bring to everyone's attention.</p>
<p>In section 2, you’re asked to compute the FRET ratio for an entire image. You must do this by 
indexing into the 3-dimensional image array to select the red channel (first page) and 
green channel (second page). We can do this with:</p>
<div class="codeblock">
<div class="blockcontent"><pre>
red_channel =  img(:, :, 1);
green_channel = img(:, :, 2);
</pre></div></div>
<p>This part is all gravy, and no one had a problem here. Next you have to compute the sum or 
average of each channel, and this is where a lot of people made a mistake. Many of you computed 
the sum of the whole image by doing:</p>
<div class="codeblock">
<div class="blockcontent"><pre>
red_channel_sum = sum(red_channel);
green_channel_sum = sum(green_channel);
</pre></div></div>
<p>But&hellip;<tt>red_channel_sum</tt> and <tt>green_channel_sum</tt> <b>are now 2D arrays, not scalars</b>, with size <tt>[1 256]</tt>! 
Reading the help for the <tt>sum</tt> function, we see that, when given a 2D array, it computes a 
sum <i>for each column</i>, summing up all the rows of that column. This means that <tt>red_channel_sum</tt> 
and <tt>green_channel_sum</tt> are arrays as well, not scalars! So in the next step, we’re supposed 
to compute the FRET ratio, which could be done by:</p>
<div class="codeblock">
<div class="blockcontent"><pre>
fret_ratio = red_channel_sum / (red_channel_sum + green_channel_sum);
</pre></div></div>
<p>But the numerator and denominator are arrays, so what is that division operator &ndash; the <tt>/</tt> &ndash; doing, 
if not scalar division? It turns out it’s doing a form of division that only really makes sense on 
matrices, or 2D arrays. (Have a look at the help for the <tt>mldivide</tt> function, if you’re curious.) 
Luckily for everyone, the arithmetic works out to be exactly the same as if you had used true scalar
division operator (<tt>./</tt>), <i>but only in this case</i>. The matrix division will almost certainly 
not work in general, and it’s definitely not what you meant to do.</p>
<p>What should we have done? The sums need to be computed differently! We want the sum of <i>all</i> elements 
in the red and green channels, not the sum for each column. To get that, we have a couple of options.</p>
<ol>
<li><p>We can call <tt>sum</tt> twice, once to get the sum for each column and once to sum that resulting row 
vector. This looks like:</p>
</li>
</ol>
<div class="codeblock">
<div class="blockcontent"><pre>
red_channel_sum = sum(sum(red_channel));
</pre></div></div>
<ol>
<li><p>The alternative possibility&ndash;which is sneaky and cool&ndash;is to force these 2D matrices to be 
1D arrays before we sum them. We can do this with a nice use of colon-indexing, and looks like:</p>
</li>
</ol>
<div class="codeblock">
<div class="blockcontent"><pre>
red_channel_sum = sum(red_channel(:));
</pre></div></div>
<p>And this brings us to the final point in this comment: <b>always use <tt>./</tt> (dot-slash) when you want 
scalar division</b>. You might think this is a weird take-home lesson, given that we were just talking 
about summing 2D arrays versus 1D arrays. But let’s look at what would have happened if we had used 
the <i>incorrect</i> <tt>sum</tt> but the <i>correct</i> division operator, the one with the dot before the slash.</p>
<p>When computing the FRET ratio for the image, we would have done this:</p>
<div class="codeblock">
<div class="blockcontent"><pre>
fret_ratio = red_channel_sum ./ (red_channel_sum + green_channel_sum); % NOTE THE DOT BEFORE THE SLASH
</pre></div></div>
<p>This will do element-wise division of two arrays of size <tt>[1 256]</tt>, meaning the output, <tt>fret_ratio</tt>, 
would be that size as well. But you know you were looking for a single number for each image, so the 
fact that we get 256-element array out would be pretty suspicious. And anytime your code isn’t doing 
what you expect, that’s a good thing when you’re trying to debug. In this case, it would have led you
to investigate why the arrays <tt>red_channel_sum</tt> and <tt>green_channel_sum</tt> are the wrong size, which
would have led you back to the <tt>sum</tt> function, which is the ultimate cause of the problem.</p>
<p>Please feel free to email the instructors
(<a href="mailto:nens230-aut1415-staff@lists.stanford.edu" target=&ldquo;blank&rdquo;>nens230-aut1415-staff@lists.stanford.edu</a>) if you have any questions about these concepts.</p>
<div id="footer">
<div id="footer-text">
Page generated 2014-10-28 12:03:15 PDT, by <a href="https://github.com/wsshin/jemdoc_mathjax" target="blank">jemdoc+MathJax</a>.
</div>
</div>
</td>
</tr>
</table>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
	  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
